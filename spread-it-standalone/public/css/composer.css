:root{
  --bg:#0b0f14; --panel:rgba(255,255,255,0.04); --glass:rgba(255,255,255,0.06);
  --accent:linear-gradient(90deg,#7b61ff,#00d4ff);
  --muted:rgba(255,255,255,0.6);
}
body.composer-dark{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:radial-gradient(ellipse at 20% 10%, rgba(124,58,237,0.12), transparent 10%), linear-gradient(180deg,#06070a,#0b0f14); color:#eaf2ff; height:100vh; margin:0;}
.composer-backdrop{position:fixed; inset:0; backdrop-filter:blur(6px) saturate(1.05); -webkit-backdrop-filter:blur(6px);}
.composer-topbar{position:fixed;left:0;right:0;top:0;height:56px;display:flex;align-items:center;justify-content:space-between;padding:0 20px;background:linear-gradient(180deg, rgba(255,255,255,0.03), transparent);box-shadow:0 8px 30px rgba(2,6,23,0.6);z-index:40}
.composer-topbar .brand{font-weight:700;letter-spacing:0.6px}
.btn-small{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:6px 10px;border-radius:8px}
.composer-stage{display:flex;align-items:center;justify-content:center;height:100vh;padding-top:56px}
.cards-stack{position:relative;width:820px;height:520px;display:flex;align-items:center;justify-content:center}
.post-card{position:absolute;width:620px;height:420px;border-radius:18px;box-shadow:0 12px 40px rgba(2,6,23,0.7);overflow:hidden;transition:transform .25s ease, box-shadow .25s ease}
.post-card.underset{transform:scale(.96)}
.post-card.underside{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.04)}
.post-card.card-4{transform:translateY(36px) scale(.92);filter:brightness(.85)}
.post-card.card-3{transform:translateY(24px) scale(.94);filter:brightness(.9)}
.post-card.card-2{transform:translateY(12px) scale(.96);filter:brightness(.95)}
.post-card.top-card{transform:translateY(0) scale(1);border:1px solid rgba(255,255,255,0.06);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.03));backdrop-filter: blur(4px);}
.card-header{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;border-bottom:1px solid rgba(255,255,255,0.02)}
.platforms .badge.p{display:inline-block;padding:6px 10px;border-radius:14px;margin-right:6px;font-size:13px;color:#fff;opacity:0.95}
.platforms .facebook{background:#1877f2}
.platforms .twitter{background:#1da1f2}
.platforms .instagram{background:linear-gradient(45deg,#f09433,#e6683c,#dc2743)}
.platforms .linkedin{background:#0077b5}
.card-actions button{margin-left:8px}
.btn-accent{background:var(--accent);color:#021; padding:8px 12px;border-radius:10px;border:none}
.btn-ghost{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:8px}
.card-body{padding:18px;height:300px;display:flex;flex-direction:column}
.editor{flex:1;padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(0,0,0,0.28), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.03);outline:none;color:#eaf2ff;overflow:auto}
.editor:empty:before{content:attr(data-placeholder);color:rgba(234,242,255,0.45)}
.card-footer{display:flex;justify-content:space-between;align-items:center;padding:12px 18px;border-top:1px solid rgba(255,255,255,0.02)}
.meta-right button{margin-left:8px}
.btn-outline{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 12px;border-radius:8px}
.btn-primary{background:linear-gradient(90deg,#00c6ff,#0072ff);border:none;padding:8px 14px;border-radius:10px;color:#041}
.ai-chat{position:fixed;right:24px;bottom:24px;width:420px;max-width:92vw;height:68vh;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border-radius:14px;box-shadow:0 20px 60px rgba(2,6,23,0.6);display:flex;flex-direction:column;z-index:60;transform:translateY(20px);opacity:0;pointer-events:none;transition:all .25s ease}
.ai-chat.open{transform:translateY(0);opacity:1;pointer-events:auto}
/* Header spinner when AI is generating */
.ai-chat.loading .ai-header::after{content:'';display:inline-block;width:16px;height:16px;margin-left:10px;border-radius:50%;border:2px solid rgba(255,255,255,0.12);border-top-color:#00d4ff;animation:spin 0.9s linear infinite}
.ai-header{padding:12px 16px;border-bottom:1px solid rgba(255,255,255,0.02);display:flex;justify-content:space-between;align-items:center}
.ai-messages{flex:1;padding:12px 16px;overflow:auto}
.ai-messages .msg{margin-bottom:10px;padding:10px 12px;border-radius:12px;max-width:78%}
.ai-messages .msg.user{background:rgba(0,150,255,0.12);align-self:flex-end}
.ai-messages .msg.ai{background:rgba(255,255,255,0.04);align-self:flex-start}
.ai-messages .msg.system{align-self: center; background:rgba(0,255,150,0.08); color:#aaffaa; font-size:0.9em; border:1px dashed rgba(0,255,150,0.2); width:90%}
.ai-messages .msg.ai.typing{opacity:0.9;font-style:italic}
.ai-form{display:flex;padding:12px;border-top:1px solid rgba(255,255,255,0.02)}
.ai-form input{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#eaf2ff;margin-right:8px}
.btn-send{background:linear-gradient(90deg,#7b61ff,#00d4ff);border:none;padding:8px 12px;border-radius:10px;color:#021}
.close{background:transparent;border:none;color:var(--muted);font-size:16px}
@media(max-width:900px){.cards-stack{width:92vw;height:56vh}.post-card{width:92vw;height:52vh}.ai-chat{right:8px;left:8px;width:auto;bottom:12px}}

/* Active card loading highlight */
.post-card.top-card.loading{box-shadow:0 30px 80px rgba(0,180,255,0.12),0 10px 40px rgba(0,120,255,0.08);transform:translateY(-6px) scale(1.01);border-color:rgba(0,180,255,0.12)}

/* --- SOCIAL PREVIEWS (REALISM) --- */

.platform-cards {
    display: flex;
    flex-wrap: wrap; /* Allow wrapping */
    gap: 20px;
    padding: 20px;
    max-width: 1400px;
    margin: 0 auto 40px;
    box-sizing: border-box;
    justify-content: center;
}

.platform-wrapper {
    flex: 0 0 350px; /* Fixed width for mobile realism */
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* Toolbar above preview */
.platform-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 4px;
    margin-bottom: 4px;
}
.platform-toolbar .left { display: flex; align-items: center; gap: 8px; font-size: 13px; color: var(--muted); }
.platform-toolbar .p-name { font-weight: 600; color: #fff; }
.status-link, .status-badge { font-size: 11px; padding: 2px 6px; border-radius: 4px; text-decoration: none; }
.status-link.disconnected { background: rgba(255, 50, 50, 0.1); color: #ff5555; border: 1px solid rgba(255,50,50,0.2); }
.status-badge.error { background: #331111; color: #ff5555; }
.btn-xs { font-size: 11px; padding: 4px 8px; border-radius: 6px; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: #ccc; }
.btn-xs:hover { background: rgba(255,255,255,0.1); color: #fff; }

/* SHARED PREVIEW STYLES */
.social-preview {
    background: #000;
    border-radius: 8px;
    overflow: hidden;
    font-size: 14px;
    line-height: 1.4;
    color: #fff;
    border: 1px solid #333;
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

.sp-header { display: flex; padding: 10px; align-items: center; gap: 10px; }
.sp-avatar img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
.sp-meta { flex: 1; display: flex; flex-direction: column; justify-content: center; }
.sp-name { font-weight: bold; font-size: 14px; display: flex; align-items: center; gap: 4px; }
.sp-sub { font-size: 12px; color: #8899a6; } /* Twitter grey */
.sp-menu { color: #8899a6; font-weight: bold; letter-spacing: 2px; }

.verified-badge { color: #1d9bf0; font-size: 12px; }

.sp-body { display: flex; flex-direction: column; } /* Default order: Text -> Media */

.sp-text-content { padding: 0 10px 10px; }
.inputs-invisible {
    width: 100%;
    background: transparent;
    border: none;
    color: inherit;
    font-family: inherit;
    font-size: inherit;
    resize: none;
    outline: none;
    min-height: 60px;
    padding: 0;
    display: block;
    line-height: 1.4;
    overflow: hidden;
}
.platform-hashtags { color: #1d9bf0; margin-top: 5px; font-size: 0.95em; }
.platform-hashtags .tag { background: transparent; padding: 0; color: #1d9bf0; margin-right: 4px; }

.sp-media {
    background: #111;
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    margin-bottom: 5px;
}
.sp-media img, .sp-media video { width: 100%; height: auto; display: block; }
.sp-media:empty { display: none; } /* Hide if no media */

.sp-footer { padding: 10px; border-top: 1px solid #2f3336; display: flex; align-items: center; color: #8899a6; font-size: 13px; }
.act { margin-right: 15px; cursor: pointer; display: inline-flex; align-items: center; gap: 4px; }
.act:hover { color: #1d9bf0; }

/* === TWITTER SPECIFIC === */
.social-preview.p-twitter { background: #000; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
.p-twitter .sp-sub { color: #71767b; } 
.p-twitter .inputs-invisible { font-size: 15px; }
.p-twitter .platform-hashtags { color: #1d9bf0; }

/* === FACEBOOK SPECIFIC === */
.social-preview.p-facebook { background: #242526; font-family: Helvetica, Arial, sans-serif; border: 1px solid #3e4042; }
.p-facebook .sp-sub { color: #b0b3b8; }
.p-facebook .inputs-invisible { font-size: 15px; }
.p-facebook .sp-footer { justify-content: space-between; padding: 4px 10px; }
.p-facebook .fb-acts { width: 100%; display: flex; justify-content: space-between; padding-top: 4px; }
.p-facebook .act { flex: 1; justify-content: center; padding: 6px 0; border-radius: 4px; color: #b0b3b8; font-weight: 600; margin: 0; }
.p-facebook .act:hover { background: rgba(255,255,255,0.1); }
.p-facebook .globe-icon { font-size: 10px; opacity: 0.7; }

/* === INSTAGRAM SPECIFIC === */
.social-preview.p-instagram { background: #000; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; border: 1px solid #262626; }
.p-instagram .sp-body { flex-direction: column-reverse; /* Media FIRST, then Text */ } 
.p-instagram .sp-media { margin-bottom: 0; min-height: 350px; } /* Square-ish */
.p-instagram .sp-footer { border-top: none; padding: 8px 12px 0; display: block; }
.p-instagram .ig-acts { display: flex; font-size: 24px; color: #f5f5f5; margin-bottom: 8px; }
.p-instagram .ig-acts .act { margin-right: 16px; }
.p-instagram .ig-acts .spacer { flex: 1; }
.p-instagram .ig-acts .act:last-child { margin-right: 0; }
.p-instagram .ig-likes { font-weight: 600; font-size: 14px; margin-bottom: 6px; }
.p-instagram .sp-text-content { padding: 0 12px 12px; }
.p-instagram .sp-text-content { display: block; } /* Caption is below actions */
.p-instagram .sp-name { font-size: 13px; }

/* === LINKEDIN SPECIFIC === */
.social-preview.p-linkedin { background: #1b1f23; font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; border: 1px solid #333; }
.p-linkedin .sp-avatar img { border-radius: 0; /* Boxy avatar sometimes on LI pages */ width: 48px; height: 48px; } 
.p-linkedin .sp-text-content { font-size: 14px; color: #fff; }
.p-linkedin .sp-footer { padding: 4px 12px; justify-content: space-between; }
.p-linkedin .ln-acts .act { margin-right: 8px; padding: 10px 8px; border-radius: 4px; font-weight: 600; color: #e7e9ea; font-size: 14px; }
.p-linkedin .ln-acts .act:hover { background: rgba(255,255,255,0.1); }

/* === TIKTOK SPECIFIC === */
.social-preview.p-tiktok { position: relative; height: 500px; background: #000; border: none; }
.p-tiktok .sp-body { height: 100%; display: flex; flex-direction: column; }
.p-tiktok .sp-media { height: 100%; object-fit: cover; opacity: 0.6; margin: 0; width: 100%; min-height: 100%; }
.tiktok-overlay { position: absolute; bottom: 0; left: 0; right: 0; padding: 10px; color: #fff; background: linear-gradient(transparent, rgba(0,0,0,0.8)); display: flex; justify-content: space-between; align-items: flex-end; }
.tiktok-side { display: flex; flex-direction: column; gap: 15px; align-items: center; padding-bottom: 20px; padding-right: 5px; }
.tt-icon { font-size: 24px; text-shadow: 0 1px 3px rgba(0,0,0,0.5); cursor: pointer; }
.tiktok-bottom { flex: 1; padding-right: 10px; }
.tk-name { font-weight: 700; margin-bottom: 5px; text-shadow: 0 1px 2px #000; }
.tk-desc { font-size: 14px; text-shadow: 0 1px 2px #000; opacity: 0.9; margin-bottom: 10px; }
.tk-sound { font-size: 12px; opacity: 0.8; display: flex; align-items: center; gap: 5px; }
/* Hide default input for tiktok as it's just visual overlay */
.p-tiktok .sp-text-content { display: none; } 

/* Fix visibility of hashtags in editor since we moved them */
.platform-hashtags { display: flex; flex-wrap: wrap; gap: 4px; }
