<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="tiktok-developers-site-verification" content="NyPBtRH4x5RVlQYdGh4qZJcwC80UGjUL">
    <meta name="application-name" content="Spread It">
    <% if (googleVerification) { %><meta name="google-site-verification" content="<%= googleVerification %>"><% } %>
    <title>Spread It</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        :root {
            --bg: #0d0d14;
            --surface: #13131f;
            --border: rgba(255,255,255,0.07);
            --accent: #8b5cf6;
            --accent2: #6366f1;
            --text: #f0f0f5;
            --muted: rgba(240,240,245,0.45);
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
        }

        /* ‚îÄ‚îÄ Glow bg ‚îÄ‚îÄ */
        body::before {
            content: '';
            position: fixed;
            top: -200px;
            left: 50%;
            transform: translateX(-50%);
            width: 900px;
            height: 600px;
            background: radial-gradient(ellipse at center, rgba(139,92,246,.18) 0%, transparent 70%);
            pointer-events: none;
            z-index: 0;
        }

        /* ‚îÄ‚îÄ Navbar ‚îÄ‚îÄ */
        nav {
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border);
            background: rgba(13,13,20,0.85);
            backdrop-filter: blur(16px);
            padding: 0 2rem;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .nav-logo {
            display: flex;
            align-items: center;
            gap: .5rem;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text);
            text-decoration: none;
            letter-spacing: -.3px;
        }
        .nav-logo .logo-dot {
            width: 28px; height: 28px;
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            font-size: .85rem;
        }

        /* ‚îÄ‚îÄ Hero ‚îÄ‚îÄ */
        .hero {
            position: relative;
            z-index: 1;
            text-align: center;
            padding: 90px 1.5rem 60px;
        }
        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: .4rem;
            background: rgba(139,92,246,.15);
            border: 1px solid rgba(139,92,246,.35);
            border-radius: 999px;
            padding: 5px 14px;
            font-size: .78rem;
            font-weight: 600;
            color: #c4b5fd;
            letter-spacing: .3px;
            margin-bottom: 1.6rem;
        }
        .hero h1 {
            font-size: clamp(2.2rem, 5vw, 3.6rem);
            font-weight: 800;
            line-height: 1.1;
            letter-spacing: -1.5px;
            margin-bottom: 1.1rem;
            background: linear-gradient(135deg, #fff 30%, #c4b5fd 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .hero p {
            font-size: 1.05rem;
            color: var(--muted);
            max-width: 460px;
            margin: 0 auto 2.8rem;
            line-height: 1.65;
        }

        /* ‚îÄ‚îÄ Upload panel ‚îÄ‚îÄ */
        .upload-panel {
            background: rgba(255,255,255,0.04);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 24px;
            max-width: 560px;
            margin: 0 auto;
            padding: 2rem;
        }
        .upload-tabs {
            display: flex;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 4px;
            margin-bottom: 1.6rem;
            gap: 4px;
        }
        .upload-tab {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--muted);
            padding: 9px 0;
            border-radius: 9px;
            font-weight: 600;
            font-size: .85rem;
            cursor: pointer;
            transition: all .2s;
            font-family: 'Inter', sans-serif;
        }
        .upload-tab.active {
            background: rgba(139,92,246,.25);
            color: #c4b5fd;
        }
        .drop-zone {
            border: 2px dashed rgba(255,255,255,0.12);
            border-radius: 16px;
            padding: 2.2rem 1rem;
            text-align: center;
            cursor: pointer;
            transition: all .2s;
            position: relative;
        }
        .drop-zone:hover, .drop-zone.drag-over {
            border-color: var(--accent);
            background: rgba(139,92,246,.07);
        }
        .drop-zone input[type="file"] {
            position: absolute;
            inset: 0;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }
        .drop-zone .dz-icon {
            font-size: 2.2rem;
            margin-bottom: .5rem;
            opacity: .8;
        }
        .drop-zone .dz-label {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text);
        }
        .drop-zone .dz-sub {
            font-size: .78rem;
            color: var(--muted);
            margin-top: .3rem;
        }
        .upload-progress {
            display: none;
            background: rgba(255,255,255,0.06);
            border-radius: 999px;
            overflow: hidden;
            height: 6px;
            margin-top: 1rem;
        }
        .upload-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), #60a5fa);
            width: 0%;
            transition: width .3s;
            border-radius: 999px;
        }
        .selected-file-info {
            display: none;
            align-items: center;
            gap: .6rem;
            background: rgba(139,92,246,.1);
            border: 1px solid rgba(139,92,246,.2);
            border-radius: 12px;
            padding: .65rem 1rem;
            margin-top: .8rem;
            font-size: .85rem;
        }
        .url-input-group {
            display: flex;
            flex-direction: column;
            gap: .75rem;
        }
        .url-input-group input[type="text"] {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: var(--text);
            padding: 12px 16px;
            font-size: .95rem;
            outline: none;
            transition: border .2s;
            font-family: 'Inter', sans-serif;
        }
        .url-input-group input[type="text"]::placeholder { color: var(--muted); }
        .url-input-group input[type="text"]:focus { border-color: var(--accent); }
        .media-type-row {
            display: flex;
            gap: .5rem;
        }
        .media-type-btn {
            flex: 1;
            background: rgba(0,0,0,0.25);
            border: 1px solid rgba(255,255,255,0.08);
            color: var(--muted);
            border-radius: 10px;
            padding: 8px;
            font-size: .8rem;
            cursor: pointer;
            transition: all .2s;
            font-family: 'Inter', sans-serif;
        }
        .media-type-btn.active {
            background: rgba(139,92,246,.2);
            border-color: rgba(139,92,246,.4);
            color: #c4b5fd;
        }
        .btn-launch {
            width: 100%;
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            color: white;
            border: none;
            border-radius: 14px;
            padding: 15px;
            font-size: 1rem;
            font-weight: 700;
            margin-top: 1.2rem;
            cursor: pointer;
            transition: all .2s;
            box-shadow: 0 4px 24px rgba(139,92,246,.35);
            letter-spacing: .1px;
            font-family: 'Inter', sans-serif;
        }
        .btn-launch:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(139,92,246,.5);
        }
        .btn-launch:disabled {
            opacity: .35;
            cursor: default;
            transform: none;
            box-shadow: none;
        }
        .error-msg {
            color: #fca5a5;
            font-size: .8rem;
            margin-top: .5rem;
            display: none;
        }

        /* ‚îÄ‚îÄ Platform pills ‚îÄ‚îÄ */
        .platforms {
            display: flex;
            justify-content: center;
            gap: .6rem;
            flex-wrap: wrap;
            margin-top: 2rem;
            opacity: .55;
        }
        .platform-pill {
            font-size: .75rem;
            font-weight: 600;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 999px;
            padding: 5px 12px;
            color: var(--muted);
            letter-spacing: .2px;
        }

        /* ‚îÄ‚îÄ Features ‚îÄ‚îÄ */
        .features {
            position: relative;
            z-index: 1;
            padding: 80px 1.5rem;
        }
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1rem;
            max-width: 960px;
            margin: 0 auto;
        }
        .feature-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border);
            border-radius: 18px;
            padding: 1.6rem;
            transition: border-color .2s, background .2s;
        }
        .feature-card:hover {
            border-color: rgba(139,92,246,.3);
            background: rgba(139,92,246,.05);
        }
        .feature-icon {
            width: 42px; height: 42px;
            background: rgba(139,92,246,.15);
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: #c4b5fd;
        }
        .feature-card h4 {
            font-size: .95rem;
            font-weight: 700;
            margin-bottom: .4rem;
            color: var(--text);
        }
        .feature-card p {
            font-size: .82rem;
            color: var(--muted);
            line-height: 1.6;
        }

        /* ‚îÄ‚îÄ Footer ‚îÄ‚îÄ */
        footer {
            position: relative;
            z-index: 1;
            border-top: 1px solid var(--border);
            padding: 2rem 1.5rem;
            text-align: center;
            color: var(--muted);
            font-size: .8rem;
        }
        footer a {
            color: var(--muted);
            text-decoration: none;
            margin: 0 .6rem;
            transition: color .2s;
        }
        footer a:hover { color: var(--text); }
    </style>
    <link rel="stylesheet" href="/css/composer.css">
</head>
<body>

    <nav>
        <a class="nav-logo" href="#">
            <span class="logo-dot">üöÄ</span>
            Spread It
        </a>
    </nav>

    <section class="hero">
        <div class="hero-badge">
            <i class="fas fa-bolt"></i> Publie partout en quelques secondes
        </div>
        <h1>Ton contenu,<br>toutes les plateformes.</h1>
        <p>Uploade un fichier ou colle une URL ‚Äî l'IA g√©n√®re les textes, tu publies sur toutes tes plateformes.</p>

        <div class="upload-panel">
            <div class="upload-tabs">
                <button class="upload-tab active" id="tabFile" onclick="switchTab('file')">
                    <i class="fas fa-upload me-1"></i> Depuis l'ordi
                </button>
                <button class="upload-tab" id="tabUrl" onclick="switchTab('url')">
                    <i class="fas fa-link me-1"></i> Via URL
                </button>
            </div>

            <div id="panelFile">
                <div class="drop-zone" id="dropZone">
                    <input type="file" id="fileInput" accept="video/*,image/*">
                    <div class="dz-icon">üìÅ</div>
                    <div class="dz-label">Glisse ton fichier ici</div>
                    <div class="dz-sub">ou clique pour parcourir &bull; Vid√©o ou image &bull; jusqu'√† 500 MB</div>
                </div>
                <div class="selected-file-info" id="fileInfo">
                    <span id="fileInfoIcon">üé¨</span>
                    <span id="fileInfoName" style="flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap"></span>
                    <span id="fileInfoSize" style="opacity:.5;font-size:.78rem"></span>
                </div>
                <div class="upload-progress" id="uploadProgress">
                    <div class="upload-progress-bar" id="uploadProgressBar"></div>
                </div>
                <div class="error-msg" id="fileError"></div>
                <button class="btn-launch" id="btnLaunchFile" disabled onclick="launchFromFile()">
                    <i class="fas fa-magic me-2"></i>Ouvrir le composer
                </button>
            </div>

            <div id="panelUrl" style="display:none">
                <div class="url-input-group">
                    <input type="text" id="urlInput" placeholder="https://example.com/video.mp4" autocomplete="off" spellcheck="false">
                    <div class="media-type-row">
                        <button class="media-type-btn" id="typeAuto" onclick="selectType('auto')">üîç Auto-detect</button>
                        <button class="media-type-btn active" id="typeVideo" onclick="selectType('video')">üé¨ Vid√©o</button>
                        <button class="media-type-btn" id="typeImage" onclick="selectType('image')">üñºÔ∏è Image</button>
                    </div>
                </div>
                <div class="error-msg" id="urlError"></div>
                <button class="btn-launch" id="btnLaunchUrl" onclick="launchFromUrl()">
                    <i class="fas fa-magic me-2"></i>Ouvrir le composer
                </button>
            </div>
        </div>

        <div class="platforms">
            <span class="platform-pill">Instagram</span>
            <span class="platform-pill">TikTok</span>
            <span class="platform-pill">YouTube</span>
            <span class="platform-pill">Facebook</span>
            <span class="platform-pill">LinkedIn</span>
            <span class="platform-pill">Twitter / X</span>
        </div>
    </section>

    <section class="features">
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-brain"></i></div>
                <h4>Textes g√©n√©r√©s par IA</h4>
                <p>L'IA adapte le texte au ton et aux r√®gles de chaque plateforme automatiquement.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-share-alt"></i></div>
                <h4>6 plateformes en 1 clic</h4>
                <p>Instagram, TikTok, YouTube, Facebook, LinkedIn et Twitter en une seule action.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-clock"></i></div>
                <h4>Timing optimal</h4>
                <p>Publication aux meilleures heures pour maximiser l'engagement de ton audience.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-mobile-alt"></i></div>
                <h4>Interface rapide</h4>
                <p>Con√ßu pour aller vite ‚Äî de l'upload √† la publication en moins de 2 minutes.</p>
            </div>
        </div>
    </section>

    <footer>
        <p style="margin-bottom:.8rem">&copy; 2026 Spread It</p>
        <div>
            <a href="/privacy" target="_blank">Politique de confidentialit√©</a>
            <span style="opacity:.3">¬∑</span>
            <a href="/terms" target="_blank">Conditions d'utilisation</a>
            <span style="opacity:.3">¬∑</span>
            <a href="/data-deletion" target="_blank">Suppression des donn√©es</a>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Composer modal (iframe) -->
        <div id="composerModal" style="display:none;position:fixed;inset:0;z-index:2000;align-items:center;justify-content:center;"> 
            <div style="position:absolute;inset:0;background:rgba(0,0,0,.6);"></div>
            <div style="position:relative;width:90%;max-width:1100px;height:80%;background:transparent;border-radius:8px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.5)">
                <button id="closeComposer" style="position:absolute;right:8px;top:8px;z-index:10;background:#fff;border:none;border-radius:6px;padding:6px 10px;cursor:pointer">‚úï</button>
                <iframe id="composerFrame" src="" style="width:100%;height:100%;border:0;display:block;background:transparent"></iframe>
            </div>
        </div>

        <script>
        // ‚îÄ‚îÄ Composer modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function showComposer(url) {
            fetch('/api/auth/issue-token')
                .then(function(r) { return r.ok ? r.json() : null; })
                .then(function(data) {
                    if (data && data.token) {
                        var sep = url.indexOf('?') >= 0 ? '&' : '?';
                        url = url + sep + 'si_token=' + encodeURIComponent(data.token);
                    }
                    var modal = document.getElementById('composerModal');
                    var frame = document.getElementById('composerFrame');
                    frame.src = url;
                    modal.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                })
                .catch(function() {
                    var modal = document.getElementById('composerModal');
                    var frame = document.getElementById('composerFrame');
                    frame.src = url;
                    modal.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                });
        }
        function hideComposer() {
            var modal = document.getElementById('composerModal');
            var frame = document.getElementById('composerFrame');
            frame.src = '';
            modal.style.display = 'none';
            document.body.style.overflow = '';
        }
        document.getElementById('closeComposer').addEventListener('click', hideComposer);
        window.SpreadIt = window.SpreadIt || {};
        window.SpreadIt.openComposer = function(q) { showComposer('/composer' + (q ? ('?' + q) : '')); };

        // ‚îÄ‚îÄ Tab switch ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function switchTab(tab) {
            document.getElementById('panelFile').style.display = tab === 'file' ? '' : 'none';
            document.getElementById('panelUrl').style.display  = tab === 'url'  ? '' : 'none';
            document.getElementById('tabFile').classList.toggle('active', tab === 'file');
            document.getElementById('tabUrl').classList.toggle('active', tab === 'url');
        }

        // ‚îÄ‚îÄ File upload tab ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        var selectedFile = null;

        var dropZone = document.getElementById('dropZone');
        ['dragenter','dragover'].forEach(function(e) {
            dropZone.addEventListener(e, function(ev) { ev.preventDefault(); dropZone.classList.add('drag-over'); });
        });
        ['dragleave','drop'].forEach(function(e) {
            dropZone.addEventListener(e, function(ev) { ev.preventDefault(); dropZone.classList.remove('drag-over'); });
        });
        dropZone.addEventListener('drop', function(ev) {
            var files = ev.dataTransfer.files;
            if (files.length) handleFile(files[0]);
        });
        document.getElementById('fileInput').addEventListener('change', function() {
            if (this.files.length) handleFile(this.files[0]);
        });

        function handleFile(file) {
            selectedFile = file;
            var info = document.getElementById('fileInfo');
            var isVideo = file.type.startsWith('video/');
            document.getElementById('fileInfoIcon').textContent = isVideo ? 'üé¨' : 'üñºÔ∏è';
            document.getElementById('fileInfoName').textContent = file.name;
            document.getElementById('fileInfoSize').textContent = formatSize(file.size);
            info.style.display = 'flex';
            document.getElementById('fileError').style.display = 'none';
            document.getElementById('btnLaunchFile').disabled = false;
        }

        function formatSize(bytes) {
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        function launchFromFile() {
            if (!selectedFile) return;
            var btn = document.getElementById('btnLaunchFile');
            var errEl = document.getElementById('fileError');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Upload en cours‚Ä¶';
            errEl.style.display = 'none';

            var progress = document.getElementById('uploadProgress');
            var bar = document.getElementById('uploadProgressBar');
            progress.style.display = 'block';

            var formData = new FormData();
            formData.append('media', selectedFile);

            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/api/upload-media', true);
            xhr.upload.onprogress = function(e) {
                if (e.lengthComputable) bar.style.width = Math.round(e.loaded / e.total * 100) + '%';
            };
            xhr.onload = function() {
                progress.style.display = 'none';
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-magic me-2"></i>Ouvrir le composer';
                if (xhr.status === 200) {
                    var data = JSON.parse(xhr.responseText);
                    var param = data.type === 'video' ? 'video_url' : 'poster';
                    showComposer('/composer?' + param + '=' + encodeURIComponent(data.url));
                } else {
                    var msg = 'Erreur upload';
                    try { msg = JSON.parse(xhr.responseText).error || msg; } catch(e) {}
                    errEl.textContent = msg;
                    errEl.style.display = 'block';
                }
            };
            xhr.onerror = function() {
                progress.style.display = 'none';
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-magic me-2"></i>Ouvrir le composer';
                errEl.textContent = 'Erreur r√©seau ‚Äî r√©essaie.';
                errEl.style.display = 'block';
            };
            xhr.send(formData);
        }

        // ‚îÄ‚îÄ URL tab ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        var selectedType = 'video';

        function selectType(t) {
            selectedType = t;
            ['auto','video','image'].forEach(function(id) {
                document.getElementById('type' + id.charAt(0).toUpperCase() + id.slice(1))
                    .classList.toggle('active', id === t);
            });
        }
        // Default: video selected
        selectType('video');

        function launchFromUrl() {
            var url = document.getElementById('urlInput').value.trim();
            var errEl = document.getElementById('urlError');
            errEl.style.display = 'none';
            if (!url) { errEl.textContent = 'Colle une URL d\'abord.'; errEl.style.display = 'block'; return; }
            try { new URL(url); } catch(e) { errEl.textContent = 'URL invalide.'; errEl.style.display = 'block'; return; }

            var type = selectedType;
            if (type === 'auto') {
                var ext = url.split('?')[0].split('.').pop().toLowerCase();
                type = /mp4|mov|avi|webm|mkv/.test(ext) ? 'video' : 'image';
            }
            var param = type === 'video' ? 'video_url' : 'poster';
            showComposer('/composer?' + param + '=' + encodeURIComponent(url));
        }

        // Allow Enter key in URL input
        document.getElementById('urlInput').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') launchFromUrl();
        });
        </script>
</body>
</html>